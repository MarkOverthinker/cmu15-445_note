# LRU

使用LRU算法实现一个buffer页替换策略

### 数据结构：

链表，哈希表

### 算法：

将所有无锁的缓冲页存放在链表，每次最近使用并解锁后的页和最近放入buffer pool页都插入链表尾，这样最近最少使用的页就在链表尾，而每次需要牺牲一个页面的时候就直接选择链表首的页即可。

在牺牲一个页或者给一个页上锁的时候，需要将该页从链表里移除。牺牲页的情况下找链表第一个页即可，但是给一个页上锁的时候需要找到这个页在链表里的位置，而链表查找效率低，需要遍历查询，费时较多，于是采用哈希表记录各个页在链表中的位置，在需要移除一页的时候直接查找哈希表得到该页的位置并移除即可。

### 函数实现

#### Victim

首先上锁，可使用lock\_guard。判断链表是否为空，若为空则没有可牺牲页，返回false;否则弹出链表第一个页，并移除哈希表中kv对。

#### Pin

在哈希表中查找要上锁的页的位置，若未查到，则直接返回。若查到，则在链表中移除该页，在哈希表中也移除该kv对。

#### Unpin

先查找哈希表中是否已有该页，若有则直接返回。否则将该页插入链表和哈希表中。
